{"ast":null,"code":"var _jsxFileName = \"E:\\\\hotel\\\\frontend\\\\src\\\\components\\\\Menu.js\",\n  _s = $RefreshSig$();\n// src/components/Menu.js\nimport React, { useEffect, useState } from \"react\";\nimport { useLocation } from \"react-router-dom\"; // CRITICAL: Use useLocation for query params\nimport axios from \"axios\";\nimport { io } from \"socket.io-client\";\nimport \"./Menu.css\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst socket = io(\"http://localhost:5000\");\nfunction Menu() {\n  _s();\n  // CRITICAL FIX: Reading the table number from query parameters\n  const location = useLocation();\n  const queryParams = new URLSearchParams(location.search);\n  const tableNumber = queryParams.get(\"table\");\n  const [menu, setMenu] = useState([]);\n  const [cart, setCart] = useState({});\n  const [isConnected, setIsConnected] = useState(false);\n  const [isLoading, setIsLoading] = useState(false);\n\n  // --- Utility Functions ---\n  const totalAmount = Object.values(cart).reduce((sum, item) => sum + item.price * item.quantity, 0);\n  const totalItems = Object.values(cart).reduce((sum, item) => sum + item.quantity, 0);\n  const addToCart = item => {\n    // ... (Add to cart logic)\n  };\n  const updateCartQuantity = (itemId, newQuantity) => {\n    // ... (Update quantity logic)\n  };\n\n  // --- Order Logic ---\n  const placeOrder = async () => {\n    if (Object.keys(cart).length === 0) {\n      alert(\"Your cart is empty!\");\n      return;\n    }\n\n    // CRITICAL VALIDATION: Check if tableNumber is valid \n    if (!tableNumber || isNaN(Number(tableNumber)) || Number(tableNumber) <= 0) {\n      alert(\"Error: Invalid table number. Please select your table again.\");\n      return;\n    }\n    const orderItems = Object.values(cart).filter(item => item && item._id && item.quantity > 0).map(item => ({\n      menuId: item._id,\n      quantity: item.quantity\n    }));\n    if (orderItems.length === 0) {\n      alert(\"Cannot place order. Please add valid items to your cart.\");\n      setCart({});\n      return;\n    }\n    setIsLoading(true);\n    try {\n      await axios.post(\"http://localhost:5000/api/orders\", {\n        tableNumber: Number(tableNumber),\n        items: orderItems,\n        totalAmount\n      });\n      alert(\"Order placed successfully! ✅\");\n      setCart({});\n    } catch (err) {\n      var _err$response, _err$response$data;\n      console.error(\"Order submission failed completely. Backend response:\", err.response ? err.response.data : err.message);\n      let errorMessage = \"Order failed. Please check stock or see console for details.\";\n      if ((_err$response = err.response) !== null && _err$response !== void 0 && (_err$response$data = _err$response.data) !== null && _err$response$data !== void 0 && _err$response$data.error) {\n        errorMessage = err.response.data.error;\n      }\n      alert(errorMessage);\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  // --- useEffect (Data & Socket) ---\n  useEffect(() => {\n    // Fetch menu items\n    // ... (fetchMenu logic)\n\n    // Initialize socket connection\n    // ... (socket setup logic)\n\n    // Cleanup function\n    return () => {\n      // ... (socket closure)\n    };\n  }, [tableNumber]); // Reloads if table number changes\n\n  // --- Render ---\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"menu-page-wrapper\",\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"menu-container\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"page-header\",\n        children: /*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"page-subtitle\",\n          children: [\"Menu for Table \", tableNumber]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 100,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 99,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"menu-grid\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 104,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 98,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 97,\n    columnNumber: 5\n  }, this);\n}\n_s(Menu, \"VmKTKbs5TDAUKxjnYvE++opGdz4=\", false, function () {\n  return [useLocation];\n});\n_c = Menu;\nexport default Menu;\nvar _c;\n$RefreshReg$(_c, \"Menu\");","map":{"version":3,"names":["React","useEffect","useState","useLocation","axios","io","jsxDEV","_jsxDEV","socket","Menu","_s","location","queryParams","URLSearchParams","search","tableNumber","get","menu","setMenu","cart","setCart","isConnected","setIsConnected","isLoading","setIsLoading","totalAmount","Object","values","reduce","sum","item","price","quantity","totalItems","addToCart","updateCartQuantity","itemId","newQuantity","placeOrder","keys","length","alert","isNaN","Number","orderItems","filter","_id","map","menuId","post","items","err","_err$response","_err$response$data","console","error","response","data","message","errorMessage","className","children","fileName","_jsxFileName","lineNumber","columnNumber","_c","$RefreshReg$"],"sources":["E:/hotel/frontend/src/components/Menu.js"],"sourcesContent":["// src/components/Menu.js\r\nimport React, { useEffect, useState } from \"react\";\r\nimport { useLocation } from \"react-router-dom\"; // CRITICAL: Use useLocation for query params\r\nimport axios from \"axios\";\r\nimport { io } from \"socket.io-client\";\r\nimport \"./Menu.css\";\r\n\r\nconst socket = io(\"http://localhost:5000\");\r\n\r\nfunction Menu() {\r\n  // CRITICAL FIX: Reading the table number from query parameters\r\n  const location = useLocation();\r\n  const queryParams = new URLSearchParams(location.search);\r\n  const tableNumber = queryParams.get(\"table\"); \r\n  \r\n  const [menu, setMenu] = useState([]);\r\n  const [cart, setCart] = useState({});\r\n  const [isConnected, setIsConnected] = useState(false);\r\n  const [isLoading, setIsLoading] = useState(false);\r\n\r\n  // --- Utility Functions ---\r\n  const totalAmount = Object.values(cart).reduce((sum, item) => sum + item.price * item.quantity, 0);\r\n  const totalItems = Object.values(cart).reduce((sum, item) => sum + item.quantity, 0);\r\n\r\n  const addToCart = (item) => {\r\n    // ... (Add to cart logic)\r\n  };\r\n  const updateCartQuantity = (itemId, newQuantity) => {\r\n    // ... (Update quantity logic)\r\n  };\r\n  \r\n  // --- Order Logic ---\r\n  const placeOrder = async () => {\r\n    if (Object.keys(cart).length === 0) {\r\n      alert(\"Your cart is empty!\");\r\n      return;\r\n    }\r\n    \r\n    // CRITICAL VALIDATION: Check if tableNumber is valid \r\n    if (!tableNumber || isNaN(Number(tableNumber)) || Number(tableNumber) <= 0) {\r\n        alert(\"Error: Invalid table number. Please select your table again.\");\r\n        return;\r\n    }\r\n\r\n    const orderItems = Object.values(cart)\r\n      .filter(item => item && item._id && item.quantity > 0)\r\n      .map(item => ({\r\n        menuId: item._id,\r\n        quantity: item.quantity,\r\n      }));\r\n\r\n    if (orderItems.length === 0) {\r\n      alert(\"Cannot place order. Please add valid items to your cart.\");\r\n      setCart({});\r\n      return;\r\n    }\r\n\r\n    setIsLoading(true);\r\n\r\n    try {\r\n      await axios.post(\"http://localhost:5000/api/orders\", {\r\n        tableNumber: Number(tableNumber), \r\n        items: orderItems,\r\n        totalAmount\r\n      });\r\n\r\n      alert(\"Order placed successfully! ✅\");\r\n      setCart({});\r\n    } catch (err) {\r\n      console.error(\"Order submission failed completely. Backend response:\", err.response ? err.response.data : err.message);\r\n      let errorMessage = \"Order failed. Please check stock or see console for details.\";\r\n      if (err.response?.data?.error) {\r\n        errorMessage = err.response.data.error;\r\n      }\r\n      alert(errorMessage);\r\n    } finally {\r\n      setIsLoading(false);\r\n    }\r\n  };\r\n  \r\n  // --- useEffect (Data & Socket) ---\r\n  useEffect(() => {\r\n    // Fetch menu items\r\n    // ... (fetchMenu logic)\r\n\r\n    // Initialize socket connection\r\n    // ... (socket setup logic)\r\n\r\n    // Cleanup function\r\n    return () => {\r\n      // ... (socket closure)\r\n    };\r\n  }, [tableNumber]); // Reloads if table number changes\r\n\r\n  // --- Render ---\r\n  return (\r\n    <div className=\"menu-page-wrapper\">\r\n      <div className=\"menu-container\">\r\n        <div className=\"page-header\">\r\n          <p className=\"page-subtitle\">Menu for Table {tableNumber}</p>\r\n          {/* ... connection status display ... */}\r\n        </div>\r\n        \r\n        <div className=\"menu-grid\">\r\n          {/* ... (Menu item rendering JSX here, using menu.map) ... */}\r\n        </div>\r\n      </div>\r\n      \r\n      {/* ... (Sticky Cart Summary JSX here, using placeOrder) ... */}\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default Menu;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}